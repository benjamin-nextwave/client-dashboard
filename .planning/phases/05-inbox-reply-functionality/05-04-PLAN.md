---
phase: 05-inbox-reply-functionality
plan: 04
type: execute
wave: 3
depends_on: ["05-02", "05-03"]
files_modified: []
autonomous: false
---

<objective>
Build verification and visual checkpoint for the complete inbox and reply functionality.

Purpose: Ensure all inbox components compile, pages render correctly, and the full flow is visually verified by the user.

Output: Verified working inbox system.
</objective>

<execution_context>
@C:\Users\bstei\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\bstei\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-inbox-reply-functionality/05-01-SUMMARY.md
@.planning/phases/05-inbox-reply-functionality/05-02-SUMMARY.md
@.planning/phases/05-inbox-reply-functionality/05-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build verification and fix any compilation issues</name>
  <files></files>
  <action>
Run `npx tsc --noEmit` and `npm run build` to verify the entire application compiles.

If any TypeScript or build errors are found:
- Fix type mismatches, missing imports, or incorrect interface usage
- Ensure all server/client component boundaries are correct ('use client' directives where needed)
- Verify all dynamic route params use Next.js 15 Promise-based params pattern
- Verify all Server Action imports are correct

Do NOT change functionality or add features. Only fix compilation/build errors.
  </action>
  <verify>`npm run build` completes successfully with no errors.</verify>
  <done>Application builds without errors. All inbox pages and components compile correctly.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete inbox and reply system:
1. Inbox list page at /dashboard/inbox showing positive leads with Gmail-style layout
2. Status badges: "Nieuwe lead" (green) and "In gesprek" (blue)
3. Thread view at /dashboard/inbox/[leadId] with conversation display
4. Contact details sidebar with name, company, job title, email, LinkedIn, vacancy URL
5. Reply form at bottom of thread view
6. "Nieuwe Email" compose modal
7. Server actions for sending replies through Instantly API
  </what-built>
  <how-to-verify>
1. Visit http://localhost:3000/dashboard/inbox as a client user
2. Verify the inbox list shows positive leads (if any exist in synced data)
3. Check that each row shows: name, company, subject/preview, date, status badge
4. Click a lead to open the thread view at /dashboard/inbox/[leadId]
5. Verify the contact card shows all available details on the right
6. Verify conversation messages are displayed (or loading state if no cached emails)
7. Check the reply form at the bottom has subject pre-filled and body textarea
8. Click "Nieuwe Email" button to verify compose modal opens
9. If this is a recruitment client, verify vacancy URL appears in contact card
10. Test on mobile viewport: verify layout stacks properly

Note: Actual email sending requires valid Instantly API key with email scopes. Visual verification of the UI layout and data display is sufficient for this checkpoint.
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
- `npm run build` passes
- Inbox list page renders at /dashboard/inbox
- Thread view page renders at /dashboard/inbox/[leadId]
- All components display correctly with proper styling
- User has visually verified the inbox system
</verification>

<success_criteria>
- Build succeeds with zero errors
- User confirms inbox list displays correctly
- User confirms thread view displays correctly
- User confirms reply form and compose modal are functional UI-wise
</success_criteria>

<output>
After completion, create `.planning/phases/05-inbox-reply-functionality/05-04-SUMMARY.md`
</output>
